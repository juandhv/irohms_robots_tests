<launch>
	<arg name="robot" default="cob4-8" /> <!-- cob4-5, cob4-7, cob4-8, cob4-10, cob4-13, cob4-16, cob4-24 -->
	<arg name="robot_env" default="empty" /> <!-- empty, ipa-apartment, ipa-kitchen, ipa-office -->
	<arg name="pkg_hardware_config" default="$(find cob_hardware_config)"/>
	<arg name="pkg_moveit_config" default="$(find cob_moveit_config)"/>
	<arg name="debug" default="false"/>
	<arg name="pipeline" default="ompl" />
	<arg name="scene_objects" default="pick_place" />
	
	<arg name="mapping" default="true" />
	<arg name="world_name" default="test_zone_pick_place.sdf" /> <!-- test_zone.sdf, test_zone_pick_place.sdf -->
	<arg name="moveit" default="true"/>
	<arg name="output" default="log"/>
	<arg name="map_file" default="simulation_map_gmapping"/>

    <!-- next three arguments are not used yet -->
	<arg name="allow_active_sensing" default="true"/>
	<arg name="vicon_bridge_params_file" default="localization_tests.yaml"/>
	<arg name="prepare_robot_pick_place" default="true" />
    
    <arg name="gui" default="true"/>

	<!-- initial position of robot for localization testing -->
	<arg name="x_pose" default="0.0"/>
	<arg name="y_pose" default="0.0"/>

  	
  	<!-- Start Gazebo simulation -->
  	<include file="$(find cob_bringup_sim)/launch/robot.launch" >
  		<arg name="robot" value="$(arg robot)" />
  		<arg name="robot_env" value="$(arg robot_env)" />
  		<arg name="gui" value="$(arg gui)" />
        <arg name="initial_config" value="-x $(arg x_pose) -y $(arg y_pose)" />
  	</include>

	<!-- 2d mapping with gmapping -->
	<!-- <include file="$(find cob_mapping_slam)/launch/2dslam.xml"/> -->

	

	<!-- Including RVIZ to monitor mapping -->
	<include file="$(find test_cob4_desktop_bringup)/launch/rviz.launch"/>

	<!-- MoveIt! -->
	<group if="$(arg moveit)">
		<include file="$(find cob_moveit_bringup)/launch/move_group.launch" >
			<arg name="robot" value="$(arg robot)" />
			<arg name="pkg_hardware_config" value="$(arg pkg_hardware_config)"/>
			<arg name="pkg_moveit_config" value="$(arg pkg_moveit_config)"/>
			<arg name="load_robot_description" value="true"/>
			<arg name="allow_trajectory_execution" value="true"/>
			<arg name="fake_execution" value="false"/>
			<arg name="use_sensors" value="false"/>
			<arg name="info" value="true"/>
			<arg name="debug" value="$(arg debug)"/>
			<arg name="pipeline" value="$(arg pipeline)" />
		</include>
	</group>

	<!-- Moving cob4 to its home state -->
	<node pkg="test_cob4_common_bringup" type="cob4_moveit_home" name="cob4_moveit_home" output="screen" />

	<!-- Teleop included for convenience -->
	<node pkg="teleop_twist_keyboard" type="teleop_twist_keyboard.py" name="teleop_twist_keyboard" output="screen" launch-prefix="xterm -e">
		<remap from="/cmd_vel" to="/base/twist_controller/command"/>
	</node>


</launch>
